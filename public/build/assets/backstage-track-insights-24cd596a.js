import{bm as ge,bT as Kt,bU as Gs,m as C,bV as Re,bW as Ts,bX as $s,bY as Vs,a as se,j as s,R as Be,c as A,l as Ks,ah as cs,aK as Qs,aL as Zs,aM as Ys,$ as ke,bZ as Qt,b_ as Zt,b$ as us,r as d,c0 as K,k as qe,c1 as ts,c2 as as,c3 as fe,c4 as je,c5 as Le,c6 as ze,c7 as Xs,b as te,b6 as le,n as we,c8 as X,c9 as Yt,ca as Xt,cb as Jt,cc as ea,cd as sa,ce as ta,cf as aa,o as J,I as W,u as oe,aG as Js,cg as et,ch as na,ci as ra,T as u,aT as ia,q as ds,J as We,B as $,t as Ge,w as Ke,A as Qe,al as ae,Y as z,d as ms,E as H,aX as la,i as xs,ab as fs,aS as be,L as he,a3 as st,cj as oa,ck as ca,cl as ua,cm as da,ar as hs,K as ma,cn as xa,bP as fa,y as Ne,e as Ue,D as ie,aI as Ms,P as ha,co as F,an as pa,cp as ga,aY as ja,cq as ba,M as ps,U as ce,X as va,bR as Fs,bS as ya,V as ee,cr as ka,cs as wa,ac as Ze,a6 as Ye,p as L,W as ue,aA as Ce,x as ne,au as Ie,am as de,aq as me,aZ as gs,ap as tt,v as at,a5 as nt,_ as rt,a0 as it,Z as lt,a1 as Y,ax as ot,G as Na,bl as Ca,bk as Ia,N as ct,ct as ut,f as Da,at as Xe,a4 as Sa,bo as Pa,aa as Aa,aH as Ta,cu as $a,bu as Va,bv as Rs,b0 as dt,b4 as Ma,b1 as mt,Q as Fa}from"./main-4c666f43.js";import{K as Ra,a as La,A as js,C as xt,a1 as za,j as ft,G as bs,p as Ua,y as Ee,Z as ht,J as Ea,z as _e,D as _a,b as vs,u as Oa,Y as pt,E as Ha,O as gt,r as Je,n as ys,H as es,x as Ba,a2 as qa,S as Wa,i as Ga,R as Ka,T as Qa,s as ks,q as Oe,I as Za,F as Ya,c as Xa,e as Ja,f as Ae,g as en,h as Te,_ as sn,X as jt,B as tn,t as Ls,P as an,U as nn,o as bt}from"./play-arrow-filled-e8d22254.js";import{E as ws}from"./Edit-9104d542.js";function vt(e){return e.set({hour:0,minute:0,second:0,millisecond:0})}function O(e){return e.set({hour:24-1,minute:60-1,second:60-1,millisecond:1e3-1})}function rn(){var a;const e=ge().settings.dates.default_timezone,t=((a=ge().user)==null?void 0:a.timezone)||e||"auto";return!t||t==="auto"?Kt():t}const P=vt(Gs(rn()));var Ws;const $e=((Ws=ge().i18n)==null?void 0:Ws.language)||"en",yt=[{key:0,label:C("Today"),getRangeValue:()=>({preset:0,start:P,end:O(P)})},{key:1,label:C("Yesterday"),getRangeValue:()=>({preset:1,start:P.subtract({days:1}),end:O(P).subtract({days:1})})},{key:2,label:C("This week"),getRangeValue:()=>({preset:2,start:Re(P,$e),end:Ts(O(P),$e)})},{key:3,label:C("Last week"),getRangeValue:()=>({preset:3,start:Re(P,$e).subtract({weeks:1}),end:Ts(O(P),$e).add({weeks:1})})},{key:4,label:C("Last 7 days"),getRangeValue:()=>({preset:4,start:P.subtract({days:7}),end:O(P)})},{key:5,label:C("Last 14 days"),getRangeValue:()=>({preset:5,start:P.subtract({days:14}),end:O(P)})},{key:6,label:C("Last 30 days"),getRangeValue:()=>({preset:6,start:P.subtract({days:30}),end:O(P)})},{key:7,label:C("Last 3 months"),getRangeValue:()=>({preset:7,start:P.subtract({months:3}),end:O(P)})},{key:8,label:C("Last 12 months"),getRangeValue:()=>({preset:8,start:P.subtract({months:12}),end:O(P)})},{key:9,label:C("This year"),getRangeValue:()=>({preset:9,start:$s(P),end:Vs(O(P))})},{key:10,label:C("Last year"),getRangeValue:()=>({preset:10,start:$s(P).subtract({years:1}),end:Vs(O(P)).subtract({years:1})})}],kt=se(s.jsx("path",{d:"M7 11h2v2H7v-2zm14-5v14c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2l.01-14c0-1.1.88-2 1.99-2h1V2h2v2h8V2h2v2h1c1.1 0 2 .9 2 2zM5 8h14V6H5v2zm14 12V10H5v10h14zm-4-7h2v-2h-2v2zm-4 0h2v-2h-2v2z"}),"DateRangeOutlined"),wt=Be.forwardRef((e,t)=>{const{children:a,inputProps:n,wrapperProps:r,className:i,autoFocus:o,style:l,onClick:c}=e;return s.jsx("div",{...r,onClick:c,children:s.jsx("div",{...n,role:"group",className:A(i,"flex items-center focus-within:ring focus-within:ring-primary/focus focus-within:border-primary/60"),ref:t,style:l,children:s.jsx(Ks,{autoFocus:o,children:a})})})}),Nt=Be.forwardRef(({inputRef:e,wrapperProps:t,children:a,onBlur:n,...r},i)=>{const o=cs(r),l=Qs(i),{fieldProps:c,inputProps:f}=Zs({...r,focusRef:l,labelElementType:"span"});return o.wrapper=A(o.wrapper,r.disabled&&"pointer-events-none"),s.jsx(Ys,{wrapperProps:ke(t,{onBlur:m=>{l.current.contains(m.relatedTarget)||n==null||n(m)},onClick:()=>{Qt(l).focusFirst()}}),fieldClassNames:o,ref:l,...c,children:s.jsx(wt,{inputProps:f,className:A(o.input,"gap-10"),ref:e,children:a})})});function ln(e){return e instanceof Zt?"day":"minute"}function is(e,t,a){return t!=null&&e.compare(t)<0||a!=null&&e.compare(a)>0}function Ct(e,t){const a=us(),[n,r]=d.useState(!1),i=t.closeDialogOnSelection??!0,o=t.granularity||ln(e),l=t.min?K(t.min,a):void 0,c=t.max?K(t.max,a):void 0;return{timezone:a,granularity:o,min:l,max:c,calendarIsOpen:n,setCalendarIsOpen:r,closeDialogOnSelection:i}}function De(){const e=us();return d.useMemo(()=>Gs(e),[e])}function on(e){var Z,w;const t=De(),[a,n]=d.useState({start:(!e.value||!e.value.start)&&!((Z=e.defaultValue)!=null&&Z.start),end:(!e.value||!e.value.end)&&!((w=e.defaultValue)!=null&&w.end)}),r=e.onChange,[i,o]=qe(e.value?rs(e.value,t):void 0,e.value?void 0:rs(e.defaultValue,t),e.onChange),{min:l,max:c,granularity:f,timezone:m,calendarIsOpen:g,setCalendarIsOpen:h,closeDialogOnSelection:x}=Ct(i.start,e),p=d.useCallback(()=>{n({start:!0,end:!0}),o(rs(null,t)),r==null||r(null),h(!1)},[t,o,r,h]),[b,v]=d.useState(null),[k,N]=d.useState(!1),[D,S]=d.useState(i),[R,U]=d.useState(()=>zs(i,c)),j=d.useCallback(y=>{let T=y.start,M=y.end;l&&(T=ts(T,l));const q=c?as(c,M):M;T=as(T,q);const Gt=l?ts(l,T):T;return M=ts(M,Gt),c&&(M=as(M,c)),{start:K(T,m),end:K(M,m)}},[l,c,m]),I=d.useCallback(y=>{const T={...j(y),preset:y.preset};o(T),S(T),U(zs(T,c)),n({start:!1,end:!1})},[o,j,c]),V=d.useCallback(y=>!a.start&&fe(y,D.start)||!a.end&&fe(y,D.end),[D,a]),E=d.useCallback(y=>(k||!a.start&&!a.end)&&y.compare(D.start)>=0&&y.compare(D.end)<=0,[D,a,k]),B=d.useCallback(y=>fe(y,D.start),[D]),G=d.useCallback(y=>fe(y,D.end),[D]),re=d.useCallback((y,T)=>({onPointerEnter:()=>{k&&T&&S(ns({start:b,end:y,timezone:m}))},onClick:()=>{if(!k)N(!0),v(y),S(ns({start:y,end:y,timezone:m}));else{const M=ns({start:vt(K(b,m)),end:O(K(y,m)),timezone:m});N(!1),v(null),I==null||I(M),x&&(h==null||h(!1))}}}),[b,k,I,h,x,m]);return{selectedValue:i,setSelectedValue:I,calendarIsOpen:g,setCalendarIsOpen:h,dayIsActive:V,dayIsHighlighted:E,dayIsRangeStart:B,dayIsRangeEnd:G,getCellProps:re,calendarDates:R,setIsPlaceholder:n,isPlaceholder:a,clear:p,setCalendarDates:U,min:l,max:c,granularity:f,timezone:m,closeDialogOnSelection:x}}function zs(e,t){let a=je(Le(e.start)),n=je(ze(e.end));return Xs(a,n)&&(n=ze(n.add({months:1}))),t&&n.compare(t)>0&&(n=a,a=Le(a.subtract({months:1}))),[a,n]}function ns(e){const t=K(e.start,e.timezone),a=K(e.end,e.timezone);return t.compare(a)>0?{start:a,end:t}:{start:t,end:a}}function rs(e,t){return e!=null&&e.start&&(e!=null&&e.end)?e:!(e!=null&&e.start)&&(e!=null&&e.end)?(e.start=e.end.subtract({months:1}),e):!(e!=null&&e.end)&&(e!=null&&e.start)?(e.end=e.start.add({months:1}),e):{start:t,end:t.add({months:1})}}const cn=se(s.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4v3z"}),"ArrowRightAltOutlined");function un(e,t,a,n){switch(t){case"era":case"year":case"month":case"day":return e.cycle(t,a,{round:t==="year"})}if("hour"in e)switch(t){case"dayPeriod":{const r=e.hour,i=r>=12;return e.set({hour:i?r-12:r+12})}case"hour":case"minute":case"second":return e.cycle(t,a,{round:t!=="hour",hourCycle:n.hour12?12:24})}return e}function dn(e,t,a,n){switch(t){case"day":case"month":case"year":return e.set({[t]:a})}if("hour"in e)switch(t){case"dayPeriod":{const r=e.hour,i=r>=12;return a>=12===i?e:e.set({hour:i?r-12:r+12})}case"hour":if(n.hour12){const i=e.hour>=12;!i&&a===12&&(a=0),i&&a<12&&(a+=12)}case"minute":case"second":return e.set({[t]:a})}return e}const Us={year:5,month:2,day:7,hour:2,minute:15,second:15,dayPeriod:1};function mn({segment:e,domProps:t,value:a,onChange:n,isPlaceholder:r,state:{timezone:i,calendarIsOpen:o,setCalendarIsOpen:l}}){const c=te(),f=d.useRef(""),{localeCode:m}=le(),g=we(),h=X({timeZone:i}),x=d.useMemo(()=>new Yt(m,{maximumFractionDigits:0}),[m]),p=j=>{n(dn(a,e.type,j,h.resolvedOptions()))},b=j=>{n(un(a,e.type,j,h.resolvedOptions()))},v=()=>{if(x.isValidPartialNumber(e.text)){const j=e.text.slice(0,-1),I=x.parse(j);if(j.length===0||I===0){const V=Xt(i);e.type in V&&p(V[e.type])}else p(I);f.current=j}else e.type==="dayPeriod"&&b(-1)},k=j=>{var I;if(!(j.ctrlKey||j.metaKey||j.shiftKey||j.altKey)){switch(j.key){case"ArrowLeft":j.preventDefault(),j.stopPropagation(),g.focusPrevious();break;case"ArrowRight":j.preventDefault(),j.stopPropagation(),g.focusNext();break;case"Enter":(I=j.target.closest("form"))==null||I.requestSubmit(),l(!o);break;case"Tab":break;case"Backspace":case"Delete":{j.preventDefault(),j.stopPropagation(),v();break}case"ArrowUp":j.preventDefault(),f.current="",b(1);break;case"ArrowDown":j.preventDefault(),f.current="",b(-1);break;case"PageUp":j.preventDefault(),f.current="",b(Us[e.type]||1);break;case"PageDown":j.preventDefault(),f.current="",b(-(Us[e.type]||1));break;case"Home":j.preventDefault(),f.current="",p(e.maxValue);break;case"End":j.preventDefault(),f.current="",p(e.minValue);break}R(j.key)}},N=X({hour:"numeric",hour12:!0}),D=d.useMemo(()=>{const j=new Date;return j.setHours(0),N.formatToParts(j).find(I=>I.type==="dayPeriod").value},[N]),S=d.useMemo(()=>{const j=new Date;return j.setHours(12),N.formatToParts(j).find(I=>I.type==="dayPeriod").value},[N]),R=j=>{const I=f.current+j;switch(e.type){case"dayPeriod":if(D.toLowerCase().startsWith(j))p(0);else if(S.toLowerCase().startsWith(j))p(12);else break;g.focusNext();break;case"day":case"hour":case"minute":case"second":case"month":case"year":{if(!x.isValidPartialNumber(I))return;let V=x.parse(I),E=V,B=e.minValue===0;if(e.type==="hour"&&h.resolvedOptions().hour12){switch(h.resolvedOptions().hourCycle){case"h11":V>11&&(E=x.parse(j));break;case"h12":B=!1,V>12&&(E=x.parse(j));break}e.value>=12&&V>1&&(V+=12)}else V>e.maxValue&&(E=x.parse(j));if(Number.isNaN(V))return;const G=E!==0||B;G&&p(E),+`${V}0`>e.maxValue||I.length>=String(e.maxValue).length?(f.current="",G&&g.focusNext()):f.current=I;break}}},U=c?{}:{"aria-label":e.type,"aria-valuetext":r?void 0:`${e.value}`,"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":r?void 0:e.value,tabIndex:0,onKeyDown:k};return s.jsx("div",{...ke(t,{...U,onFocus:j=>{f.current="",j.target.scrollIntoView({block:"nearest"})},onClick:j=>{j.preventDefault(),j.stopPropagation()}}),className:"p-2 outline-none caret-transparent cursor-default rounded focus:bg-primary focus:text-on-primary select-none whitespace-nowrap box-content tabular-nums text-center",children:e.text.padStart(e.minLength,"0")})}function xn({segment:e,domProps:t}){const a=we();return s.jsx("div",{...t,onPointerDown:n=>{n.pointerType==="mouse"&&(n.preventDefault(),a.focusNext({from:n.target})||a.focusPrevious({from:n.target}))},"aria-hidden":!0,className:"min-w-4 cursor-default select-none",children:e.text})}function fn(e,t,a){switch(t){case"year":return{value:e.year,placeholder:"yyyy",minValue:1,maxValue:e.calendar.getYearsInEra(e)};case"month":return{value:e.month,placeholder:"mm",minValue:ea(e),maxValue:e.calendar.getMonthsInYear(e)};case"day":return{value:e.day,minValue:Jt(e),maxValue:e.calendar.getDaysInMonth(e),placeholder:"dd"}}if("hour"in e)switch(t){case"dayPeriod":return{value:e.hour>=12?12:0,minValue:0,maxValue:12,placeholder:"--"};case"hour":if(a.hour12){const n=e.hour>=12;return{value:e.hour,minValue:n?12:0,maxValue:n?23:11,placeholder:"--"}}return{value:e.hour,minValue:0,maxValue:23,placeholder:"--"};case"minute":return{value:e.minute,minValue:0,maxValue:59,placeholder:"--"}}return{}}function ls({segmentProps:e,state:t,value:a,onChange:n,isPlaceholder:r}){const{granularity:i}=t,o=d.useMemo(()=>{const m={year:"numeric",month:"numeric",day:"numeric"};return i==="minute"&&(m.hour="numeric",m.minute="numeric"),m},[i]),l=X(o),c=d.useMemo(()=>a.toDate(),[a]),f=d.useMemo(()=>l.formatToParts(c).map(m=>{const g=fn(a,m.type,l.resolvedOptions()),h=r&&m.type!=="literal"?g.placeholder:m.value;return{type:m.type,text:m.value===", "?" ":h,...g,minLength:m.type!=="literal"?String(g.maxValue).length:1}}),[c,l,r,a]);return s.jsx("div",{className:"flex items-center",children:f.map((m,g)=>m.type==="literal"?s.jsx(xn,{domProps:e,segment:m},g):s.jsx(mn,{isPlaceholder:r,domProps:e,state:t,value:a,onChange:n,segment:m},g))})}function hn({date:e,currentMonth:t,state:{dayIsActive:a,dayIsHighlighted:n,dayIsRangeStart:r,dayIsRangeEnd:i,getCellProps:o,timezone:l,min:c,max:f}}){const{localeCode:m}=le(),g=sa(e,m),h=a(e),x=n(e),p=r(e),b=i(e),v=ta(e,l),k=Xs(e,t),N=is(e,c,f);return s.jsxs("div",{role:"button","aria-disabled":N,className:A("w-40 h-40 text-sm relative isolate flex-shrink-0",N&&"text-disabled pointer-events-none",!k&&"invisible pointer-events-none"),...o(e,k),children:[s.jsx("span",{className:A("absolute inset-0 flex items-center justify-center rounded-full w-full h-full select-none z-10 cursor-pointer",!h&&!v&&"hover:bg-hover",h&&"bg-primary text-on-primary font-semibold",v&&!h&&"bg-chip"),children:e.day}),x&&k&&s.jsx("span",{className:A("absolute w-full h-full inset-0 bg-primary/focus",(p||g===0||e.day===1)&&"rounded-l-full",(b||g===6||e.day===t.calendar.getDaysInMonth(t))&&"rounded-r-full")})]})}function pn({startDate:e,state:t,isFirst:a,isLast:n}){const{localeCode:r}=le(),i=aa(e,r),o=Re(e,r);return s.jsxs("div",{className:"w-280 flex-shrink-0",children:[s.jsx(gn,{isFirst:a,isLast:n,state:t,currentMonth:e}),s.jsxs("div",{className:"block",role:"grid",children:[s.jsx(jn,{state:t,startDate:e}),[...new Array(i).keys()].map(l=>s.jsx(J.div,{className:"flex mb-6",children:[...new Array(7).keys()].map(c=>s.jsx(hn,{date:o.add({weeks:l,days:c}),currentMonth:e,state:t},c))},l))]})]})}function gn({currentMonth:e,isFirst:t,isLast:a,state:{calendarDates:n,setCalendarDates:r,timezone:i,min:o,max:l}}){const c=h=>{const x=n.length;let p;h==="forward"?p=n.map(b=>ze(b.add({months:x}))):p=n.map(b=>ze(b.subtract({months:x}))),r(p)},f=X({month:"long",year:"numeric",era:e.calendar.identifier!=="gregory"?"long":void 0,calendar:e.calendar.identifier}),m=is(e.subtract({days:1}),o,l),g=is(Le(e.add({months:1})),o,l);return s.jsxs("div",{className:"flex items-center justify-between gap-10",children:[s.jsx(W,{size:"md",className:A("text-muted",!t&&"invisible"),disabled:!t||m,"aria-hidden":!t,onClick:()=>{c("backward")},children:s.jsx(Ra,{})}),s.jsx("div",{className:"text-sm font-semibold select-none",children:f.format(e.toDate(i))}),s.jsx(W,{size:"md",className:A("text-muted",!a&&"invisible"),disabled:!a||g,"aria-hidden":!a,onClick:()=>{c("forward")},children:s.jsx(La,{})})]})}function jn({state:{timezone:e},startDate:t}){const{localeCode:a}=le(),n=X({weekday:"short"}),r=Re(t,a);return s.jsx("div",{className:"flex",children:[...new Array(7).keys()].map(i=>{const l=r.add({days:i}).toDate(e),c=n.format(l);return s.jsx("div",{className:"w-40 h-40 text-sm font-semibold relative flex-shrink-0",children:s.jsx("div",{className:"absolute flex items-center justify-center w-full h-full select-none",children:c})},i)})})}function It({state:e,visibleMonths:t=1}){return te()&&(t=1),s.jsx(s.Fragment,{children:[...new Array(t).keys()].map(n=>{const r=je(Le(e.calendarDates[n])),i=n===0,o=n===t-1;return s.jsx(pn,{state:e,startDate:r,isFirst:i,isLast:o},n)})})}const Dt=d.memo(({start:e,end:t,options:a,preset:n})=>{const{dates:r}=oe(),i=us(),o=X(a||Js[n||(r==null?void 0:r.format)]);if(!e||!t)return null;let l;try{l=o.formatRange(Es(e,i),Es(t,i))}catch{l=""}return s.jsx(d.Fragment,{children:l})},et);function Es(e,t){return typeof e=="string"?na(e,t).toDate():"toDate"in e?e.toDate(t):e}function bn({children:e,className:t,padding:a,dataTestId:n}){return s.jsx(Ks,{children:s.jsx("ul",{"data-testid":n,className:A("text-base sm:text-sm outline-none",t,a??"py-4"),children:e})})}function vn({children:e,onSelected:t,borderRadius:a,...n}){const r=we(),i=!!t,o=d.useRef(null),[l,c]=d.useState(!1),f=m=>{switch(m.key){case"ArrowDown":m.preventDefault(),r.focusNext();break;case"ArrowUp":m.preventDefault(),r.focusPrevious();break;case"Home":m.preventDefault(),r.focusFirst();break;case"End":m.preventDefault(),r.focusLast();break;case"Enter":case"Space":m.preventDefault(),t==null||t();break}};return s.jsx("li",{children:s.jsx(ra,{className:a||"rounded",isActive:l,isDisabled:n.isDisabled,...n,onFocus:m=>{c(m.target.matches(":focus-visible"))},onBlur:()=>{c(!1)},onClick:()=>{t==null||t()},ref:o,role:i?"button":void 0,onKeyDown:i?f:void 0,tabIndex:i&&!n.isDisabled?0:void 0,children:e})})}function yn({onPresetSelected:e,selectedValue:t}){return s.jsx(bn,{className:"min-w-192",padding:"py-14",dataTestId:"date-range-preset-list",children:yt.map(a=>s.jsx(vn,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(t==null?void 0:t.preset)===a.key,onSelected:()=>{const n=a.getRangeValue();e(n)},children:s.jsx(u,{...a.label})},a.key))})}function kn(e){return ia("(max-width: 1024px)",e)}function wn({state:e,showInlineDatePickerField:t=!1}){const a=kn(),{close:n}=ds(),r=d.useRef(e),i=e.isPlaceholder.start||e.isPlaceholder.end,o=s.jsxs(We,{dividerTop:!0,startAction:!i&&!a?s.jsx("div",{className:"text-xs",children:s.jsx(Dt,{start:e.selectedValue.start.toDate(),end:e.selectedValue.end.toDate(),options:{dateStyle:"medium"}})}):void 0,children:[s.jsx($,{variant:"text",size:"xs",onClick:()=>{e.setSelectedValue(r.current.selectedValue),e.setIsPlaceholder(r.current.isPlaceholder),n()},children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{variant:"flat",color:"primary",size:"xs",onClick:()=>{n(e.selectedValue)},children:s.jsx(u,{message:"Select"})})]});return s.jsxs(Ge,{size:"auto",children:[s.jsxs(Ke,{className:"flex",padding:"p-0",children:[!a&&s.jsx(yn,{selectedValue:e.selectedValue,onPresetSelected:l=>{e.setSelectedValue(l),e.closeDialogOnSelection&&n(l)}}),s.jsx(Qe,{initial:!1,children:s.jsx(Nn,{state:e,showInlineDatePickerField:t})})]}),!e.closeDialogOnSelection&&o]})}function Nn({state:e,showInlineDatePickerField:t}){return s.jsxs(J.div,{initial:{width:0,overflow:"hidden"},animate:{width:"auto"},exit:{width:0,overflow:"hidden"},transition:{type:"tween",duration:.125},className:"border-l px-20 pt-10 pb-20",children:[t&&s.jsx(Cn,{state:e}),s.jsx("div",{className:"flex items-start gap-36",children:s.jsx(It,{state:e,visibleMonths:2})})]})}function Cn({state:e}){const{selectedValue:t,setSelectedValue:a}=e;return s.jsxs(Nt,{className:"mb-20 mt-10",children:[s.jsx(ls,{state:e,value:t.start,onChange:n=>{a({...t,start:n})}}),s.jsx(cn,{className:"block flex-shrink-0 text-muted",size:"md"}),s.jsx(ls,{state:e,value:t.end,onChange:n=>{a({...t,end:n})}})]})}const xe=(e,t)=>{const a=e.split("/");return t&&a.push(t),a};function hi(e,t,a){return ae(xe(e,t),()=>In(e,t),{...a,keepPreviousData:!0})}function In(e,t){return z.get(e,{params:t}).then(a=>a.data)}const Dn=(e,t="normalized-models")=>`${t}/${e}`;function St(e,t,a,n){const r=Dn(e,n);return ae([r,t],()=>Sn(r,t),{keepPreviousData:!0,...a})}async function Sn(e,t){return z.get(e,{params:t}).then(a=>a.data)}const Pn=(e,t,a="normalized-models")=>`${a}/${e}/${t}`;function Pt(e,t,a,n){const r=Pn(e,t,n);return ae([r,a],()=>An(r,a),{enabled:e!=null&&t!=null})}async function An(e,t){return z.get(e,{params:t}).then(a=>a.data)}function Tn({modelType:e,label:t,className:a,value:n,defaultValue:r="",onChange:i,description:o,errorMessage:l,invalid:c,openMenuOnFocus:f,autoFocus:m,queryParams:g,customEndpoint:h,disabled:x}){var U;const p=d.useRef(null),[b,v]=d.useState(""),[k,N]=qe(n,r,i),D=St(e,{query:b,...g},null,h),{trans:S}=H(),R=cs({size:"md"});return k?s.jsxs("div",{className:a,children:[s.jsx("div",{className:R.label,children:t}),s.jsx("div",{className:A("p-10 border rounded",c&&"border-danger"),children:s.jsx(Qe,{initial:!1,mode:"wait",children:s.jsx($n,{disabled:x,endpoint:h,modelType:e,modelId:k,queryParams:g,onEditClick:()=>{N(""),v(""),requestAnimationFrame(()=>{var j;(j=p.current)==null||j.focus()})}})})}),o&&!l&&s.jsx("div",{className:R.description,children:o}),l&&s.jsx("div",{className:R.error,children:l})]}):s.jsx(la,{className:a,invalid:c,errorMessage:l,description:o,isAsync:!0,placeholder:S(C("Find item..")),label:t,isLoading:D.isFetching,items:(U=D.data)==null?void 0:U.results,inputValue:b,onInputValueChange:v,clearInputOnItemSelection:!0,selectionMode:"single",selectedValue:k,onSelectionChange:N,ref:p,openMenuOnFocus:f,autoFocus:m,disabled:x,children:j=>s.jsx(xs,{value:j.id,description:j.description,startIcon:s.jsx(js,{src:j.image}),children:j.name},j.id)})}function $n({modelType:e,modelId:t,onEditClick:a,endpoint:n,disabled:r,queryParams:i}){const{data:o,isLoading:l}=Pt(e,t,i,n);return l||!(o!=null&&o.model)?s.jsx(Vn,{},"skeleton"):s.jsxs(J.div,{className:A("flex items-center gap-10",r&&"text-disabled cursor-not-allowed pointer-events-none"),...fs,children:[o.model.image&&s.jsx(js,{src:o.model.image}),s.jsxs("div",{children:[s.jsx("div",{children:o.model.name}),s.jsx("div",{className:"text-muted text-xs",children:o.model.description})]}),s.jsx(be,{label:s.jsx(u,{message:"Change item"}),children:s.jsx(W,{className:"ml-auto text-muted",size:"sm",onClick:a,disabled:r,children:s.jsx(ws,{})})})]},"preview")}function Vn(){return s.jsxs(J.div,{className:"flex items-center gap-10",...fs,children:[s.jsx(he,{variant:"rect",size:"w-32 h-32"}),s.jsxs("div",{className:"flex-auto max-h-[36px]",children:[s.jsx(he,{className:"text-xs"}),s.jsx(he,{className:"text-xs max-h-8"})]}),s.jsx(he,{variant:"icon",size:"w-24 h-24"})]})}function Mn({name:e,...t}){const{field:{onChange:a,value:n=""},fieldState:{invalid:r,error:i}}=ms({name:e});return s.jsx(Tn,{value:n,onChange:a,invalid:r,errorMessage:i==null?void 0:i.message,...t})}function os(e){return{id:e,name:`${e}`,description:`${e}`}}function Fn(e,t){const a=d.useRef(null),n=Qs(t),{displayWith:r=q=>q.name,validateWith:i,children:o,suggestions:l,isLoading:c,inputValue:f,onInputValueChange:m,onItemSelected:g,placeholder:h,onOpenChange:x,chipSize:p="md",openMenuOnFocus:b=!0,showEmptyMessage:v,value:k,defaultValue:N,onChange:D,valueKey:S,isAsync:R,allowCustomValue:U=!0,showDropdownArrow:j,onChipClick:I,...V}=e,E=cs({...e,flexibleHeight:!0}),[B,G]=zn(e),[re,Z]=d.useState(!1),w=s.jsx(hs,{isIndeterminate:!0,size:"sm","aria-label":"loading..."}),y=j?s.jsx(ma,{}):null,{fieldProps:T,inputProps:M}=Zs({...V,focusRef:n,endAdornment:c&&re?w:y});return s.jsx(Ys,{fieldClassNames:E,...T,children:s.jsxs(wt,{ref:a,className:A("flex items-center flex-wrap",E.input),onClick:()=>{var q;(q=n.current)==null||q.focus()},children:[s.jsx(Rn,{displayChipUsing:r,onChipClick:I,items:B,setItems:G,chipSize:p}),s.jsx(Ln,{showEmptyMessage:v,inputProps:M,inputValue:f,onInputValueChange:m,fieldRef:a,inputRef:n,chips:B,setChips:G,validateWith:i,isLoading:c,suggestions:l,placeholder:h,openMenuOnFocus:b,listboxIsOpen:re,setListboxIsOpen:Z,allowCustomValue:U,children:o})]})})}function Rn({items:e,setItems:t,displayChipUsing:a,chipSize:n,onChipClick:r}){const i=we(),o=d.useCallback(l=>{const c=e.findIndex(m=>m.id===l),f=[...e];return c>-1&&(f.splice(c,1),t(f)),f},[e,t]);return s.jsx(xt,{className:"flex-shrink-0 flex-wrap max-w-full my-8",size:n,selectable:!0,children:e.map(l=>s.jsx(st,{errorMessage:l.errorMessage,adornment:l.image?s.jsx(js,{circle:!0,src:l.image}):null,onClick:()=>r==null?void 0:r(l),onRemove:()=>{o(l.id).length?i.focusPrevious({tabbable:!0}):i.focusLast()},children:a(l)},l.id))})}function Ln(e){const{inputRef:t,fieldRef:a,validateWith:n,setChips:r,chips:i,suggestions:o,inputProps:l,placeholder:c,openMenuOnFocus:f,listboxIsOpen:m,setListboxIsOpen:g,allowCustomValue:h}=e,x="outline-none text-sm mx-8 my-4 h-30 flex-auto",p=we(),b=d.useCallback(w=>{w=(w||[]).filter(y=>{const T=!y||!y.id||!y.name;return!(i.findIndex(q=>q.id===(y==null?void 0:y.id))>-1)&&!T}),w.length&&(n&&(w=w.map(y=>n(y))),r([...i,...w]))},[i,r,n]),v=oa({...e,clearInputOnItemSelection:!0,isOpen:m,onOpenChange:g,items:o,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:w=>{B(w)}}),{state:{activeIndex:k,setActiveIndex:N,isOpen:D,setIsOpen:S,inputValue:R,setInputValue:U},refs:j,listboxId:I,collection:V,onInputChange:E}=v,B=w=>{const y=V.size&&k!=null?[...V.values()][k]:null;y!=null&&y.item?b([y.item]):h&&b([os(y?y.value:w)]),U(""),N(null),S(!1)};ca(()=>{a.current&&j.reference.current!==a.current&&v.reference(a.current)},[a,v,j]);const{handleTriggerKeyDown:G,handleListboxKeyboardNavigation:re}=xa(v),Z=fa(()=>{f&&!D&&S(!0)});return s.jsx(ua,{listbox:v,mobileOverlay:da,onPointerDown:w=>{w.preventDefault()},children:s.jsx("input",{type:"text",className:A(x,"bg-transparent"),placeholder:c,...ke(l,{ref:t,value:R,onChange:E,onPaste:w=>{const T=w.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(T){w.preventDefault();const M=window.getSelection();M!=null&&M.rangeCount&&(M.deleteFromDocument(),b(T.map(q=>os(q))))}},"aria-autocomplete":"list","aria-controls":D?I:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:w=>{const y=w.target;if(w.key==="Enter"){w.preventDefault(),B(y.value);return}if(w.key==="Escape"&&D&&(S(!1),U("")),w.key==="ArrowUp"&&D&&(k===0||k==null)){N(null);return}if(k!=null&&(w.key==="ArrowLeft"||w.key==="ArrowRight")){w.preventDefault();return}if((w.key==="ArrowLeft"||w.key==="Backspace"||w.key==="Delete")&&y.selectionStart===0&&k==null&&i.length){p.focusPrevious({tabbable:!0});return}G(w)||re(w)},onFocus:Z,onClick:Z})})})}function zn({onChange:e,value:t,defaultValue:a,valueKey:n}){const r=d.useMemo(()=>_s(t),[t]),i=d.useMemo(()=>_s(a),[a]),o=d.useCallback(l=>{const c=n?l.map(f=>f[n]):l;e==null||e(c)},[e,n]);return qe(r||void 0,i||[],o)}function _s(e){if(e!=null)return e.map(t=>typeof t!="object"?os(t):t)}const Un=Be.forwardRef(Fn);function At({children:e,...t}){const{field:{onChange:a,onBlur:n,value:r=[],ref:i},fieldState:{invalid:o,error:l}}=ms({name:t.name}),c={onChange:a,onBlur:n,value:r,invalid:o,errorMessage:l==null?void 0:l.message};return s.jsx(Un,{ref:i,...ke(c,t),children:e})}const En=se(s.jsx("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"}),"DragHandleOutlined");function _n(){const[e,t]=d.useState(!1),a=d.useRef(),n=d.useCallback(r=>{var i;if(r){const o=new IntersectionObserver(([l])=>t(l.intersectionRatio<1),{threshold:[1]});a.current=o,o.observe(r)}else a.current&&((i=a.current)==null||i.disconnect())},[]);return{isSticky:e,sentinelRef:n}}function Se({onSubmit:e,form:t,title:a,children:n,isLoading:r=!1,disableSaveWhenNotDirty:i=!1,wrapInContainer:o=!0}){const{isSticky:l,sentinelRef:c}=_n(),f=i?Object.keys(t.formState.dirtyFields).length:!0;return s.jsxs(Ne,{onSubmit:e,onBeforeSubmit:()=>{t.clearErrors()},form:t,children:[s.jsx("div",{ref:c}),s.jsx("div",{className:A("sticky top-0 my-12 md:my-24 z-10 transition-shadow",l&&"bg-paper shadow"),children:s.jsxs("div",{className:A("flex items-center md:items-start gap-24 md:gap-80 py-14",o&&"container mx-auto px-24"),children:[s.jsx("h1",{className:"text-xl md:text-3xl whitespace-nowrap overflow-hidden overflow-ellipsis",children:a}),s.jsx($,{className:"ml-auto",variant:"flat",color:"primary",type:"submit",disabled:r||!f,children:s.jsx(u,{message:"Save"})})]})}),s.jsx("div",{className:o?"container mx-auto px-24 pb-24":void 0,children:s.jsx("div",{className:"rounded",children:n})})]})}function On(e){const t=De(),[a,n]=d.useState(!e.value&&!e.defaultValue),r=e.onChange,[i,o]=qe(e.value||t,e.defaultValue||t,r),{min:l,max:c,granularity:f,timezone:m,calendarIsOpen:g,setCalendarIsOpen:h,closeDialogOnSelection:x}=Ct(i,e),p=d.useCallback(()=>{n(!0),o(t),r==null||r(null),h(!1)},[t,o,r,h]),[b,v]=d.useState(()=>[je(i)]),k=d.useCallback(S=>{l&&S.compare(l)<0?S=l:c&&S.compare(c)>0&&(S=c);const R=i?i.set(S):K(S,m);o(R),v([je(R)]),n(!1)},[o,l,c,i,m]),N=d.useCallback(S=>!a&&fe(i,S),[i,a]),D=d.useCallback(S=>({onClick:()=>{k==null||k(S),x&&(h==null||h(!1))}}),[k,h,x]);return{selectedValue:i,setSelectedValue:o,calendarIsOpen:g,setCalendarIsOpen:h,dayIsActive:N,dayIsHighlighted:()=>!1,dayIsRangeStart:()=>!1,dayIsRangeEnd:()=>!1,getCellProps:D,calendarDates:b,setCalendarDates:v,isPlaceholder:a,clear:p,setIsPlaceholder:n,min:l,max:c,granularity:f,timezone:m,closeDialogOnSelection:x}}function Hn({showCalendarFooter:e,...t}){const a=On(t),n=d.useRef(null),r=De(),i=e&&s.jsx(We,{padding:"px-14 pb-14",startAction:s.jsx($,{disabled:a.isPlaceholder,variant:"text",color:"primary",onClick:()=>{a.clear()},children:s.jsx(u,{message:"Clear"})}),children:s.jsx($,{variant:"text",color:"primary",onClick:()=>{a.setSelectedValue(r),a.setCalendarIsOpen(!1)},children:s.jsx(u,{message:"Today"})})}),o=s.jsx(ie,{offset:8,placement:"bottom-start",isOpen:a.calendarIsOpen,onOpenChange:a.setCalendarIsOpen,type:"popover",triggerRef:n,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:s.jsxs(Ge,{size:"auto",children:[s.jsx(Ke,{className:"flex items-start gap-40",padding:e?"px-24 pt-20 pb-10":null,children:s.jsx(It,{state:a,visibleMonths:1})}),i]})}),l={onClick:c=>{c.stopPropagation(),c.preventDefault(),qn(c)?a.setCalendarIsOpen(!1):a.setCalendarIsOpen(!0)}};return s.jsxs(d.Fragment,{children:[s.jsx(Nt,{ref:n,wrapperProps:l,endAdornment:s.jsx(kt,{className:A(t.disabled&&"text-disabled")}),...t,children:s.jsx(ls,{segmentProps:l,state:a,value:a.selectedValue,onChange:a.setSelectedValue,isPlaceholder:a.isPlaceholder})}),o]})}function Bn(e){const{min:t,max:a}=e,{trans:n}=H(),{format:r}=X(),{field:{onChange:i,onBlur:o,value:l=null,ref:c},fieldState:{invalid:f,error:m}}=ms({name:e.name,rules:{validate:x=>{if(!x)return;const p=Ue(x);if(t&&p.compare(t)<0)return n({message:"Enter a date after :date",values:{date:r(x)}});if(a&&p.compare(a)>0)return n({message:"Enter a date before :date",values:{date:r(x)}})}}}),g=l?Ue(l):null,h={onChange:x=>{i(x&&x.toAbsoluteString())},onBlur:o,value:g,invalid:f,errorMessage:m==null?void 0:m.message,inputRef:c};return s.jsx(Hn,{...ke(h,e)})}function qn(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}const Wn=se(s.jsx("path",{d:"M9 8a1 1 0 0 0-1-1H5.5a1 1 0 1 0 0 2H7v4a1 1 0 0 0 2 0zM4 0h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4zm4 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}),"InfoDialogTrigger"),Tt=""+new URL("music-7a11c2fe.svg",import.meta.url).href;function Gn(e){return ae(["artists","search-suggestions",e],()=>Kn(e),{keepPreviousData:!0})}async function Kn(e){return z.get("search/suggestions/artist",{params:e}).then(t=>t.data)}function $t({name:e,className:t}){const{trans:a}=H(),[n,r]=d.useState(""),{data:i,isLoading:o}=Gn({query:n});return s.jsx(At,{className:t,name:e,label:s.jsx(u,{message:"Artists"}),isAsync:!0,inputValue:n,onInputValueChange:r,suggestions:i==null?void 0:i.results,placeholder:a(C("+Add artist")),isLoading:o,allowCustomValue:!1,children:i==null?void 0:i.results.map(l=>s.jsx(xs,{value:l,startIcon:l.image?s.jsx("img",{className:"rounded-full object-cover w-24 h-24",src:l.image,alt:""}):void 0,children:l.name},l.id))})}function ve({name:e,label:t,placeholder:a,model:n,className:r,allowCustomValue:i=!1}){const[o,l]=d.useState(""),{data:c,isLoading:f}=St(n,{query:o});return s.jsx(At,{className:r,name:e,label:t,isAsync:!0,inputValue:o,onInputValueChange:l,suggestions:c==null?void 0:c.results,placeholder:a,isLoading:f,allowCustomValue:i,children:c==null?void 0:c.results.map(m=>s.jsx(xs,{value:m,startIcon:m.image?s.jsx("img",{className:"rounded-full object-cover w-24 h-24",src:m.image,alt:""}):void 0,children:m.name},m.id))})}const Vt="tag",Mt=se(s.jsx("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}),"FileUploadOutlined");function Ft({fileUpload:e,status:t,className:a}){const n=(e==null?void 0:e.bytesUploaded)||0,r=d.useMemo(()=>Ms(e.file.size),[e.file.size]),i=d.useMemo(()=>Ms(n),[n]);let o;return t==="completed"?o=s.jsx(u,{message:"Upload complete"}):t==="aborted"?o=s.jsx(u,{message:"Upload cancelled"}):t==="failed"?o=s.jsx(u,{message:"Upload failed"}):t==="processing"?o=s.jsx(u,{message:"Processing upload..."}):t==="pending"?o=s.jsx(u,{message:"Waiting to start..."}):o=s.jsx(u,{message:":bytesUploaded of :totalBytes uploaded",values:{bytesUploaded:i,totalBytes:r}}),s.jsx("div",{className:A("text-muted text-xs",a),children:o})}function Rt({fileUpload:e,status:t,onAbort:a,size:n="md",className:r}){return s.jsxs("div",{className:r,children:[s.jsxs("div",{className:"flex items-center gap-24 justify-between",children:[s.jsx(Ft,{fileUpload:e,status:t}),s.jsx(Qn,{fileUpload:e,status:t,onAbort:a})]}),s.jsx(ha,{size:n==="sm"?"xs":"sm",radius:"rounded-sm",value:e.percentage,isIndeterminate:t==="processing"||t==="pending"})]})}function Qn({fileUpload:e,status:t,onAbort:a}){F(i=>i.abortUpload),F(i=>i.clearInactive);const n=e.errorMessage;let r;if(t==="failed"){const i=n||C("This file could not be uploaded");r=s.jsx(Ve,{children:s.jsx(be,{variant:"danger",label:s.jsx(pa,{value:i}),children:s.jsx(ga,{className:"text-danger",size:"sm"})})})}else t==="aborted"?r=s.jsx(Ve,{children:s.jsx(ja,{className:"text-warning",size:"sm"})}):t==="completed"||t==="processing"?r=s.jsx(Ve,{children:s.jsx(ba,{size:"sm",className:"text-primary"})}):a?r=s.jsx(Ve,{children:s.jsx(W,{size:"xs",onClick:()=>a(e.file.id),children:s.jsx(ps,{})})}):r=s.jsx("div",{className:"w-30 h-30"});return s.jsx(Qe,{children:r})}function Ve({children:e,...t}){return s.jsx(J.div,{className:"flex w-30 h-30 items-center justify-center",...t,initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},children:e})}function Zn(){return ce(e=>Yn(e),{onError:e=>va(e)})}function Yn(e){return z.post(`tracks/${e.fileEntryId}/extract-metadata`,e).then(t=>Xn(t.data))}function Xn(e){const t={name:e.metadata.title,duration:e.metadata.duration,genres:e.metadata.genres||[],description:e.metadata.comment,lyric:e.metadata.lyrics,release_date:e.metadata.release_date,album_name:e.metadata.album_name};return e.metadata.album&&(t.album_id=e.metadata.album.id),e.metadata.artist&&(t.artists=[e.metadata.artist]),e.metadata.image&&(t.image=e.metadata.image.url),t}function Lt(e,t){var a,n;!((a=e.getValues("artists"))!=null&&a.length)&&t.artists&&e.setValue("artists",t.artists),!e.getValues("image")&&t.image&&e.setValue("image",t.image),t.release_date&&e.setValue("release_date",t.release_date),(n=t.genres)!=null&&n.length&&e.setValue("genres",Fe(e.getValues("genres"),t.genres)),!e.getValues("name")&&t.album_name&&e.setValue("name",t.album_name)}function ye(e,t){return{...t,...e,artists:Fe(t.artists,e.artists),genres:Fe(t.genres,e.genres,"name"),tags:Fe(t.tags,e.tags,"name")}}function Fe(e=[],t=[],a="id"){return t=t.filter(n=>!e.find(r=>r[a]===n[a])),[...e,...t]}const Jn=50*1024*1024;function ss(e){const{uploads:t}=oe(),a=d.useMemo(()=>({allowedFileTypes:[Fs.audio,Fs.video],maxFileSize:t.max_size||Jn}),[t.max_size]),n=Zn(),r=d.useRef(e);r.current=e;const i=F(x=>x.uploadMultiple),o=F(x=>x.updateFileUpload),l=F(x=>x.getUpload),c=d.useCallback((x,p)=>{var b;o(x,{meta:{...((b=l(x))==null?void 0:b.meta)||{},...p}})},[o,l]),f=d.useMemo(()=>({metadata:{diskPrefix:"track_media",disk:ya.public},restrictions:a,onSuccess:(x,p)=>{c(p.id,{isExtractingMetadata:!0}),n.mutate({fileEntryId:x.id,autoMatchAlbum:r.current.autoMatchAlbum},{onSuccess:b=>{c(p.id,{isExtractingMetadata:!1});const v={...b,src:x.url};r.current.onMetadataChange(p,v)},onError:()=>{c(p.id,{isExtractingMetadata:!1})}})},onError:x=>{x&&ee.danger(x)}}),[n,c,a]),m=d.useCallback(x=>{const p=x.filter(b=>!ka(b,a));return x.length!==p.length&&ee.danger(C(":count of your files is not supported.",{values:{count:x.length-p.length}})),p},[a]),g=d.useCallback(async x=>{if(m(x).length){x.forEach(b=>{var v,k;(k=(v=r.current).onUploadStart)==null||k.call(v,{name:b.name,uploadId:b.id})}),i(x,f);for(const b of x){c(b.id,{isGeneratingWave:!0});const v=await za(b.native);v&&r.current.onMetadataChange(b,{waveData:v}),c(b.id,{isGeneratingWave:!1})}}},[f,i,c,m]);return{openFilePicker:d.useCallback(async()=>{const x=await wa({multiple:!0,types:a.allowedFileTypes});await g(x)},[g,a]),uploadTracks:g,validateUploads:m}}function Ns(e){const t=F(r=>e?r.fileUploads.get(e):null);let a=!1,n;if(t){const r=t.meta,i=(r==null?void 0:r.isExtractingMetadata)||(r==null?void 0:r.isGeneratingWave);a=(t==null?void 0:t.status)==="pending"||(t==null?void 0:t.status)==="inProgress"||!!i,n=(t==null?void 0:t.status)==="completed"&&i?"processing":t==null?void 0:t.status}return{isUploading:a,status:n,activeUpload:t}}function er(){const[e,t]=d.useState(),{setValue:a,watch:n,getValues:r}=Ze(),{openFilePicker:i}=ss({onUploadStart:({uploadId:g})=>t(g),onMetadataChange:(g,h)=>{const x=ye(h,r());Object.entries(x).forEach(([p,b])=>a(p,b,{shouldDirty:!0}))}}),{status:o,isUploading:l,activeUpload:c}=Ns(e),{abortUpload:f,clearInactive:m}=F();return s.jsxs("div",{children:[s.jsx($,{className:"w-full",variant:"flat",color:"primary",startIcon:s.jsx(Mt,{}),disabled:l,onClick:()=>i(),children:n("src")?s.jsx(u,{message:"Replace file"}):s.jsx(u,{message:"Upload file"})}),c&&s.jsx(Rt,{fileUpload:c,status:o,className:"mt-24",onAbort:g=>{f(g),m()}})]})}function Pe({showExternalIdFields:e,showAlbumField:t=!0,uploadButton:a}){const{trans:n}=H(),r=te();return s.jsxs("div",{className:"md:flex gap-24",children:[s.jsxs("div",{className:"flex-shrink-0",children:[s.jsx(Ye,{name:"image",diskPrefix:"track_image",variant:r?"input":"square",label:r?s.jsx(u,{message:"Image"}):null,previewSize:r?void 0:"w-full md:w-224 aspect-square",stretchPreview:!0}),s.jsx("div",{className:"mt-24",children:a||s.jsx(er,{})})]}),s.jsxs("div",{className:"flex-auto mt-24 md:mt-0",children:[s.jsx(L,{name:"name",label:s.jsx(u,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0}),t&&s.jsx(Mn,{className:"mb-24",label:s.jsx(u,{message:"Album"}),name:"album_id",modelType:ft,openMenuOnFocus:!0,customEndpoint:"search/suggestions"}),s.jsx($t,{name:"artists",className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Genres"}),placeholder:n(C("+Add genre")),model:bs,name:"genres",allowCustomValue:!0,className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Tags"}),placeholder:n(C("+Add tag")),model:Vt,name:"tags",allowCustomValue:!0,className:"mb-24"}),s.jsx(L,{name:"description",label:s.jsx(u,{message:"Description"}),inputElementType:"textarea",rows:5,className:"mb-24"}),s.jsx(ar,{}),e&&s.jsx(sr,{}),e&&s.jsx(tr,{})]})]})}function sr(){return s.jsx(L,{name:"src",label:s.jsx(u,{message:"Playback source"}),className:"mb-24",minLength:1,maxLength:230,description:s.jsx(u,{message:"Supports audio, video, hls/dash stream and youtube video url. If left empty, best matching youtube video will be found automatically."})})}function tr(){const{spotify_is_setup:e}=oe();return e?s.jsx(L,{name:"spotify_id",label:s.jsx(u,{message:"Spotify ID"}),className:"mb-24",minLength:22,maxLength:22}):null}function ar(){const{watch:e}=Ze();return s.jsx(L,{required:!0,name:"duration",label:s.jsx(u,{message:"Duration (in milliseconds)"}),className:"mb-24",type:"number",min:1,max:864e5,description:s.jsx(u,{message:"Will appear on the site as: :preview",values:{preview:s.jsx(Ua,{ms:e("duration")})}})})}const zt="tracks";function Ut(e,{onSuccess:t}={}){const{trans:a}=H();return ce(n=>nr(n),{onSuccess:n=>{ee(a(C("Track created"))),ue.invalidateQueries(xe(zt)),t==null||t(n)},onError:n=>Ce(n,e)})}function nr(e){return z.post(zt,Cs(e)).then(t=>t.data)}function Cs(e){var t;return{...e,album_id:e.album_id?e.album_id:null,artists:(t=e.artists)==null?void 0:t.map(a=>a.id)}}function Et({onTrackCreated:e,defaultValues:t}={}){const a=ne({defaultValues:t}),n=Ut(a,{onSuccess:e});return{form:a,createTrack:n}}function pi({wrapInContainer:e}){const t=Ie(),{pathname:a}=de(),{form:n,createTrack:r}=Et({onTrackCreated:i=>{a.includes("admin")?t(`/admin/tracks/${i.track.id}/edit`):t(Ee(i.track))}});return s.jsx(Se,{form:n,onSubmit:i=>{r.mutate(i)},title:s.jsx(u,{message:"Add new track"}),isLoading:r.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:e,children:s.jsx(me,{children:s.jsx(Pe,{showExternalIdFields:!0})})})}const rr=e=>`tracks/${e}`;function ir(e,t={}){const{trans:a}=H();return ce(n=>lr(n),{onSuccess:n=>{var r;ee(a(C("Track updated"))),ue.invalidateQueries(xe("tracks")),(r=t.onSuccess)==null||r.call(t,n)},onError:n=>Ce(n,e)})}function lr({id:e,...t}){return z.put(rr(e),Cs(t)).then(a=>a.data)}function _t(e,t={}){var r;const a=ne({defaultValues:{...e,image:e.image||((r=e.album)==null?void 0:r.image)}}),n=ir(a,{onSuccess:t.onTrackUpdated});return{form:a,updateTrack:n}}function gi({wrapInContainer:e}){const t=ht({forEditing:!0});return t.data?s.jsx(or,{track:t.data.track,wrapInContainer:e}):s.jsx(gs,{query:t,loaderClassName:"absolute inset-0 m-auto"})}function or({track:e,wrapInContainer:t}){const{canEdit:a}=Ea([e]),n=Ie(),{pathname:r}=de(),{form:i,updateTrack:o}=_t(e,{onTrackUpdated:l=>{r.includes("admin")?n("/admin/tracks"):n(Ee(l.track))}});return a?s.jsx(Se,{form:i,onSubmit:l=>{o.mutate(l)},title:s.jsx(u,{message:"Edit “:name“ track",values:{name:e.name}}),isLoading:o.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:t,children:s.jsx(me,{children:s.jsx(Pe,{showExternalIdFields:!0})})}):s.jsx(tt,{to:"/",replace:!0})}const Ot="albums";function Ht(e){const{trans:t}=H();return ce(a=>cr(a),{onSuccess:()=>{ee(t(C("Album created"))),ue.invalidateQueries(xe(Ot))},onError:a=>Ce(a,e)})}function cr(e){return z.post(Ot,Bt(e)).then(t=>t.data)}function Bt(e){var t,a;return{...e,artists:(t=e.artists)==null?void 0:t.map(n=>n.id),tracks:(a=e.tracks)==null?void 0:a.map(n=>Cs(n))}}const ur=e=>`albums/${e}`;function dr(e,t){const{trans:a}=H(),n=Ie(),{pathname:r}=de();return ce(i=>mr(t,i),{onSuccess:i=>{ee(a(C("Album updated"))),ue.invalidateQueries(xe("albums")),r.includes("admin")?n("/admin/albums"):n(_e(i.album))},onError:i=>Ce(i,e)})}function mr(e,t){return z.put(ur(e),Bt(t)).then(a=>a.data)}function xr({track:e,hideAlbumField:t}){const{formId:a,close:n}=ds(),{form:r}=_t(e);return s.jsxs(Ge,{size:"fullscreen",children:[s.jsx(at,{children:s.jsx(u,{message:"Edit “:name“ track",values:{name:e.name}})}),s.jsx(Ke,{children:s.jsx(Ne,{id:a,form:r,onSubmit:i=>{n(i)},onBeforeSubmit:()=>{r.clearErrors()},children:s.jsx(Pe,{showExternalIdFields:!0,showAlbumField:!t})})}),s.jsxs(We,{children:[s.jsx($,{variant:"text",onClick:()=>n(),children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{form:a,variant:"flat",color:"primary",type:"submit",children:s.jsx(u,{message:"Update"})})]})]})}function fr({defaultValues:e,hideAlbumField:t}){const{formId:a,close:n}=ds(),{form:r}=Et({defaultValues:e});return s.jsxs(Ge,{size:"fullscreen",children:[s.jsx(at,{children:s.jsx(u,{message:"Add new track"})}),s.jsx(Ke,{children:s.jsx(Ne,{id:a,form:r,onSubmit:i=>{n(i)},onBeforeSubmit:()=>{r.clearErrors()},children:s.jsx(Pe,{showExternalIdFields:!0,showAlbumField:!t})})}),s.jsxs(We,{children:[s.jsx($,{variant:"text",onClick:()=>n(),children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{form:a,variant:"flat",color:"primary",type:"submit",children:s.jsx(u,{message:"Create"})})]})]})}function hr(){const e=Ze(),{watch:t,setValue:a,getValues:n}=e,{fields:r,remove:i,prepend:o,move:l}=nt({name:"tracks"}),c=(g,h)=>{var p;const x=(p=n("tracks"))==null?void 0:p.findIndex(b=>b.uploadId===g);x!=null&&a(`tracks.${x}`,ye(h,n(`tracks.${x}`)),{shouldDirty:!0})},{openFilePicker:f}=ss({onUploadStart:g=>o(ye(g,{artists:e.getValues("artists"),genres:e.getValues("genres"),tags:e.getValues("tags")})),onMetadataChange:(g,h)=>{Lt(e,h),c(g.id,h)}}),m=t("tracks")||[];return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-12",children:[s.jsx("h2",{className:"text-xl font-semibold my-24",children:s.jsx(u,{message:"Tracks"})}),s.jsx($,{variant:"outline",color:"primary",size:"xs",className:"ml-auto",startIcon:s.jsx(Mt,{}),onClick:()=>f(),children:s.jsx(u,{message:"Upload tracks"})}),s.jsxs(ie,{type:"modal",onClose:g=>{g&&o(g)},children:[s.jsx(be,{label:s.jsx(u,{message:"Create track"}),children:s.jsx(W,{variant:"outline",color:"primary",size:"xs",radius:"rounded",children:s.jsx(vs,{})})}),s.jsx(fr,{hideAlbumField:!0,defaultValues:{artists:t("artists"),tags:t("tags"),genres:t("genres")}})]})]}),r.map((g,h)=>{const x=m[h];return s.jsx(pr,{track:x,onRemove:()=>i(h),onSort:(p,b)=>l(p,b),tracks:m,onUpdate:p=>{c(x.uploadId,p)}},g.id)}),r.length?null:s.jsx(rt,{className:"mt-40",image:s.jsx(it,{src:Tt}),title:s.jsx(u,{message:"This album does not have any tracks yet"})})]})}function pr({track:e,tracks:t,onRemove:a,onUpdate:n,onSort:r}){const i=d.useRef(null),o=d.useRef(null),l=F(h=>h.abortUpload),c=F(h=>e.uploadId?h.fileUploads.get(e.uploadId):null),{isUploading:f,status:m}=Ns(e.uploadId),{sortableProps:g}=Oa({disabled:f,ref:i,item:e,items:t,type:"albumFormTrack",preview:o,previewVariant:"line",onSortEnd:(h,x)=>{r(h,x)}});return s.jsxs("div",{className:"border-b border-t border-t-transparent py-4",ref:i,...g,children:[s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(W,{className:"flex-shrink-0 mr-14",disabled:f,children:s.jsx(En,{})}),s.jsx("div",{className:"flex-auto whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.name}),c&&s.jsxs("div",{className:"flex items-center mr-10",children:[s.jsx(Ft,{fileUpload:c,status:m,className:"mr-10"}),s.jsx(hs,{isIndeterminate:m==="processing",value:c.percentage,size:"sm"})]}),s.jsxs(ie,{type:"modal",onClose:h=>{h&&n(h)},children:[s.jsx(be,{label:s.jsx(u,{message:"Edit track"}),children:s.jsx(W,{className:"flex-shrink-0 ml-auto text-muted",disabled:f,children:s.jsx(ws,{})})}),s.jsx(xr,{track:e,hideAlbumField:!0})]}),s.jsxs(ie,{type:"modal",onClose:h=>{h&&(e.uploadId&&l(e.uploadId),a())},children:[s.jsx(be,{label:s.jsx(u,{message:"Remove track"}),children:s.jsx(W,{className:"flex-shrink-0 text-muted",children:s.jsx(ps,{})})}),s.jsx(lt,{isDanger:!0,title:s.jsx(u,{message:"Remove track"}),body:s.jsx(u,{message:"Are you sure you want to remove this track from the album?"}),confirm:s.jsx(u,{message:"Remove"})})]})]}),s.jsx(gr,{track:e,ref:o})]})}const gr=Be.forwardRef(({track:e},t)=>{var n,r;let a=e.name;return(n=e.artists)!=null&&n.length&&(a+=`- ${(r=e.artists)==null?void 0:r[0].name}`),s.jsx(_a,{ref:t,children:()=>s.jsx("div",{className:"p-8 rounded shadow bg-chip text-sm",children:a})})});function Is({showExternalIdFields:e}){const{trans:t}=H(),a=te();return s.jsxs(d.Fragment,{children:[s.jsxs("div",{className:"md:flex gap-24",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Ye,{name:"image",diskPrefix:"album_images",label:a?s.jsx(u,{message:"Image"}):null,variant:a?"input":"square",previewSize:a?void 0:"w-full md:w-224 aspect-square",stretchPreview:!0})}),s.jsxs("div",{className:"flex-auto mt-24 md:mt-0",children:[s.jsx(L,{name:"name",label:s.jsx(u,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0}),s.jsx(Bn,{name:"release_date",label:s.jsx(u,{message:"Release date"}),className:"mb-24",granularity:"day"}),s.jsx($t,{name:"artists",className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Genres"}),placeholder:t(C("+Add genre")),model:bs,name:"genres",allowCustomValue:!0,className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Tags"}),placeholder:t(C("+Add tag")),model:Vt,name:"tags",allowCustomValue:!0,className:"mb-24"}),s.jsx(L,{name:"description",label:s.jsx(u,{message:"Description"}),inputElementType:"textarea",rows:5,className:"mb-24"}),e&&s.jsx(jr,{})]})]}),s.jsx(hr,{})]})}function jr(){const{spotify_is_setup:e}=oe();return e?s.jsx(L,{name:"spotify_id",label:s.jsx(u,{message:"Spotify ID"}),className:"mb-24",minLength:22,maxLength:22}):null}function ji({wrapInContainer:e}){const t=pt({forEditing:!0,with:"tags,genres,artists,fullTracks"});return t.data?s.jsx(me,{children:s.jsx(br,{album:t.data.album,wrapInContainer:e})}):s.jsx(gs,{query:t,loaderClassName:"absolute inset-0 m-auto"})}function br({album:e,wrapInContainer:t}){const{canEdit:a}=Ha(e),n=!!F(o=>o.activeUploadsCount),r=ne({defaultValues:{image:e.image,name:e.name,release_date:e.release_date,artists:e.artists,genres:e.genres,tags:e.tags,description:e.description,spotify_id:e.spotify_id,tracks:e.tracks}}),i=dr(r,e.id);return a?s.jsx(Se,{form:r,onSubmit:o=>{i.mutate(o)},title:s.jsx(u,{message:"Edit “:name“ album",values:{name:e.name}}),isLoading:i.isLoading||n,disableSaveWhenNotDirty:!0,wrapInContainer:t,children:s.jsx(Is,{showExternalIdFields:!0})}):s.jsx(tt,{to:"/",replace:!0})}const vr=d.forwardRef(({onUploadStart:e,onCancel:t,onCreate:a},n)=>{const r=gt(),i=De(),[o,l]=d.useState(!1),c=ne({defaultValues:{tracks:[],artists:r?[r]:[],release_date:i.toAbsoluteString()}}),f=c.watch("tracks")||[],m=F(v=>v.abortUpload),g=!!F(v=>v.activeUploadsCount),{openFilePicker:h,uploadTracks:x,validateUploads:p}=ss({onUploadStart:v=>{l(!0),c.setValue("tracks",[...c.getValues("tracks"),v]),e()},onMetadataChange:(v,k)=>{Lt(c,k),c.setValue("tracks",c.getValues("tracks").map(N=>N.uploadId===v.id?ye(k,N):N))}});d.useImperativeHandle(n,()=>({openFilePicker:h,uploadTracks:x,validateUploads:p}),[h,x,p]);const b=Ht(c);return o?s.jsxs(Ne,{className:"rounded border p-14 md:p-24 mb-30 bg-paper",form:c,onSubmit:v=>b.mutate(v,{onSuccess:k=>{l(!1),c.reset(),a(k.album)}}),children:[s.jsx(Is,{showExternalIdFields:!1}),s.jsxs("div",{className:"mt-24",children:[s.jsx($,{variant:"text",onClick:()=>{f.forEach(v=>{m(v.uploadId)}),c.reset(),l(!1),t()},className:"mr-10",children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{type:"submit",variant:"flat",color:"primary",disabled:g||b.isLoading,children:s.jsx(u,{message:"Save"})})]})]}):null}),yr=d.forwardRef(({onUploadStart:e,onCancel:t,onCreate:a},n)=>{const r=gt(),i=F(g=>g.abortUpload),[o,l]=d.useState([]),{openFilePicker:c,uploadTracks:f,validateUploads:m}=ss({onUploadStart:g=>{l(h=>r?[...h,{...g,artists:[r]}]:[...h,g]),e()},onMetadataChange:(g,h)=>{l(x=>x.map(p=>p.uploadId===g.id?ye(h,p):p))}});return d.useImperativeHandle(n,()=>({openFilePicker:c,uploadTracks:f,validateUploads:m}),[c,f,m]),s.jsx("div",{className:"w-full",children:o.map(g=>s.jsx(kr,{track:g,onCreate:h=>{l(x=>x.filter(p=>p.uploadId!==g.uploadId)),a(h)},onRemove:()=>{l(h=>{const x=h.filter(p=>p.uploadId!==g.uploadId);return x.length||t(),x}),i(g.uploadId)}},g.uploadId))})}),kr=d.memo(({track:e,onRemove:t,onCreate:a})=>{const n=ne({defaultValues:e}),r=Ut(n),i=F(f=>f.fileUploads.get(e.uploadId)),{isUploading:o,status:l}=Ns(e.uploadId);d.useEffect(()=>{n.reset(e)},[e,n]);const c=o&&i?s.jsx(Rt,{fileUpload:i,status:l}):null;return s.jsxs(Ne,{form:n,onSubmit:f=>{r.mutate(f,{onSuccess:m=>a(m.track)})},className:"rounded border p-14 md:p-24 mb-30 bg-paper",children:[s.jsx(Pe,{uploadButton:c,showExternalIdFields:!1}),s.jsx($,{variant:"text",onClick:()=>t(),className:"mr-10",children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{type:"submit",variant:"flat",color:"primary",disabled:r.isLoading||!n.watch("src"),children:s.jsx(u,{message:"Save"})})]})}),wr=""+new URL("album-border-b5dd7d9f.png",import.meta.url).href;function Nr({media:e}){var n,r;const t=e.model_type===ft,a=t?_e(e,{absolute:!0}):Ee(e,{absolute:!0});return s.jsxs("div",{className:"flex items-center gap-28 border rounded bg-paper p-20 my-20 mx-auto w-780 max-w-full",children:[s.jsxs("div",{className:A(t&&"relative isolate my-14 mx-18"),children:[t?s.jsx(Je,{album:e,className:"rounded flex-shrink-0 z-20 relative",size:"w-132 h-132"}):s.jsx(ys,{track:e,className:"rounded flex-shrink-0 z-20 relative",size:"w-132 h-132"}),t&&s.jsx("img",{className:"absolute block w-160 h-160 max-w-160 -top-14 -left-14 z-10",src:wr,alt:""})]}),s.jsxs("div",{className:"flex-auto",children:[s.jsx("div",{className:"text-base font-bold",children:e.name}),s.jsx("div",{className:"text-muted text-sm mb-14",children:s.jsx(es,{artists:e.artists})}),(n=e.genres)!=null&&n.length?s.jsx(xt,{selectable:!1,size:"sm",className:"mb-14",children:(r=e.genres)==null?void 0:r.map(i=>s.jsx(st,{children:i.display_name||i.name},i.id))}):null,s.jsx("div",{className:"text-sm",children:s.jsx(u,{message:"Upload complete. <a>Go to your track</a>",values:{a:i=>s.jsx(Y,{className:ot,to:t?_e(e):Ee(e),children:i})}})})]}),s.jsx("div",{className:"ml-auto flex-auto max-w-300",children:s.jsxs("div",{className:"text-muted text-sm",children:[s.jsx(u,{message:"Share your new track"}),s.jsx(Ba,{name:e.name,image:e.image,link:a}),s.jsx(Na,{value:a,readOnly:!0,className:"mt-24 w-full",size:"sm",onClick:i=>{i.target.select()}})]})})]})}function Cr({isVisible:e}){const t=s.jsx(J.div,{...fs,transition:{duration:.3},className:"absolute inset-0 w-full min-h-full bg-primary-light/30 border-2 border-dashed border-primary pointer-events-none",children:s.jsx(J.div,{initial:{y:"100%",opacity:0},animate:{y:"-10px",opacity:1},exit:{y:"100%",opacity:0},className:"p-10 bg-primary text-on-primary fixed bottom-0 left-0 right-0 max-w-max mx-auto rounded",children:s.jsx(u,{message:"Drop your files anywhere on the page to upload"})})},"dragTargetMask");return s.jsx(Qe,{children:e?t:null})}function Ir(){const{user:e}=ge();e!=null&&e.id&&ue.resetQueries(["minutesLimit",e.id])}function Dr(){const{user:e}=Ca(),t=e==null?void 0:e.id;return ae(["minutesLimit",t],()=>Sr(t),{enabled:t!=null})}function Sr(e){return z.get(`users/${e}/minutes-left`).then(t=>t.data)}const Pr=""+new URL("light-bg-8c37cb47.svg",import.meta.url).href,Ar=""+new URL("dark-bg-38ecc414.svg",import.meta.url).href;function Tr({children:e,...t}){const a=Ia();return s.jsxs("div",{className:"h-full flex flex-col",...t,children:[s.jsx(ct,{className:"flex-shrink-0",color:"bg",darkModeColor:"bg"}),s.jsx("div",{className:"overflow-y-auto flex-auto bg-cover relative",style:{backgroundImage:`url(${a?Ar:Pr})`},children:s.jsxs("div",{className:"container mx-auto p-14 md:p-24 min-h-full flex flex-col",children:[s.jsx("div",{className:"flex-auto",children:e}),s.jsx(ut,{})]})})]})}function bi({backstageLayout:e=!0}){return s.jsx(me,{children:s.jsx($r,{backstageLayout:e})})}function $r({backstageLayout:e}){const[t,a]=d.useState("tracks"),[n,r]=d.useState(!1),i=d.useRef(null),o=t==="tracks"?yr:vr,[l,c]=d.useState([]),f=d.useRef(null),[m,g]=d.useState(!1),{droppableProps:h}=qa({id:"uploadPageRoot",ref:f,types:["nativeFile"],onDragEnter:()=>g(!0),onDragLeave:()=>g(!1),onDrop:async p=>{var b,v;if(p.type==="nativeFile"){const k=await p.getData(),N=(b=i.current)==null?void 0:b.validateUploads(k);N!=null&&N.length&&((v=i.current)==null||v.uploadTracks(N))}}}),x=e?Tr:Mr;return s.jsxs(x,{...h,children:[!n&&s.jsx(Vr,{onUpload:()=>{var p;return(p=i.current)==null?void 0:p.openFilePicker()},uploadMode:t,onUploadModeChange:a}),l.map(p=>s.jsx(Nr,{media:p},p.id)),s.jsx(o,{ref:i,onUploadStart:()=>r(!0),onCreate:p=>{c(b=>[...b,p]),Ir()},onCancel:()=>{r(!1)}}),s.jsx(Cr,{isVisible:m})]})}function Vr({onUpload:e,uploadMode:t,onUploadModeChange:a}){const{data:n}=Dr();return s.jsxs("div",{className:"pt-40",children:[s.jsxs("div",{className:"border rounded p-20 md:p-48 flex flex-col items-center max-w-580 mx-auto bg-paper",children:[s.jsx("h1",{className:"text-base md:text-[22px] md:font-light",children:s.jsx(u,{message:"Drag and drop your tracks, videos & albums here."})}),s.jsx($,{variant:"flat",color:"primary",className:"mt-20 w-min",onClick:()=>e(),children:s.jsx(u,{message:"Or choose files to upload"})}),s.jsx("div",{className:"border-t pt-20 mt-20",children:s.jsx(Wa,{checked:t==="album",onChange:r=>a(r.target.checked?"album":"tracks"),children:s.jsx(u,{message:"Make an album when multiple files are selected"})})})]}),s.jsx("div",{className:"text-muted mt-20 text-sm text-center min-h-20",children:(n==null?void 0:n.minutesLeft)!=null&&s.jsx(u,{message:"You have :count minutes left. Try <a>Pro accounts</a> to get more time and access to advanced features.",values:{count:n.minutesLeft,a:r=>s.jsx(Y,{className:ot,to:"/pricing",children:r})}})})]})}function Mr({children:e,...t}){return s.jsx("div",{...t,className:"min-h-full relative",children:s.jsx("div",{className:"container mx-auto p-14 md:p-24",children:e})})}function vi({wrapInContainer:e}){return s.jsx(me,{children:s.jsx(Fr,{wrapInContainer:e})})}function Fr({wrapInContainer:e}){const t=!!F(m=>m.activeUploadsCount),a=De(),n=Ie(),{pathname:r}=de(),[i]=Da(),{data:o}=Pt(Ga,i.get("artistId")),l=o==null?void 0:o.model,c=ne({defaultValues:{release_date:a.toAbsoluteString()}}),f=Ht(c);return d.useEffect(()=>{l&&c.reset({artists:[l]})},[l,c]),console.log(t),s.jsx(Se,{form:c,onSubmit:m=>{f.mutate(m,{onSuccess:g=>{r.includes("admin")?n(l?`/admin/artists/${l.id}/edit`:"/admin/albums"):n(_e(g.album))}})},title:s.jsx(u,{message:"Add new album"}),isLoading:f.isLoading||t,disableSaveWhenNotDirty:!0,wrapInContainer:e,children:s.jsx(Is,{showExternalIdFields:!0})})}function yi(){const{requestId:e}=Xe();return ae(["backstage-request",+e],()=>Rr(e))}function Rr(e){return z.get(`backstage-request/${e}`).then(t=>t.data)}const ki=se(s.jsx("path",{d:"M7 3H4v3H2V1h5v2zm15 3V1h-5v2h3v3h2zM7 21H4v-3H2v5h5v-2zm13-3v3h-3v2h5v-5h-2zM17 6H7v12h10V6zm2 12c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v12zM15 8H9v2h6V8zm0 3H9v2h6v-2zm0 3H9v2h6v-2z"}),"DocumentScannerOutlined"),Lr=[{key:"name",allowsSorting:!0,header:()=>s.jsx(u,{message:"Name"}),visibleInMode:"all",width:"flex-3",body:e=>s.jsxs("div",{className:"flex items-center gap-12",children:[s.jsx(Je,{album:e,className:"flex-shrink-0",size:"w-34 h-34 rounded"}),s.jsx(ks,{album:e,target:"_blank"})]})},{key:"release_date",allowsSorting:!0,header:()=>s.jsx(u,{message:"Release date"}),body:e=>e.release_date?s.jsx(Sa,{date:e.release_date}):null},{key:"track_count",allowsSorting:!1,header:()=>s.jsx(u,{message:"Track count"}),body:e=>e.tracks_count?s.jsx(Oe,{value:e.tracks_count}):null},{key:"plays",allowsSorting:!0,header:()=>s.jsx(u,{message:"Plays"}),body:e=>e.plays?s.jsx(Oe,{value:e.plays}):null},{key:"actions",header:()=>s.jsx(u,{message:"Actions"}),width:"w-84 flex-shrink-0",visibleInMode:"all",hideHeader:!0,align:"end",body:e=>s.jsx(Ur,{album:e})}];function zr({albums:e=[]}){const{watch:t}=Ze(),a=t("id"),{data:n,sortDescriptor:r,onSortChange:i}=Ka(e);return s.jsxs("div",{children:[s.jsxs("div",{className:"my-24",children:[s.jsxs("div",{className:"flex items-center gap-12",children:[s.jsx("h2",{className:"text-xl font-semibold",children:s.jsx(u,{message:"Albums"})}),s.jsx($,{variant:"outline",color:"primary",size:"xs",className:"ml-auto",startIcon:s.jsx(vs,{}),elementType:a?Y:void 0,to:`/admin/albums/new?artistId=${a}`,disabled:!a,children:s.jsx(u,{message:"Add album"})})]}),!a&&s.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[s.jsx(Wn,{viewBox:"0 0 16 16",size:"xs",className:"text-muted"}),s.jsx(u,{message:"Save changes to enable album creation."})]})]}),s.jsx(Qa,{columns:Lr,data:e,sortDescriptor:r,onSortChange:i,enableSelection:!1}),n.length?null:s.jsx(rt,{className:"mt-40",image:s.jsx(it,{src:Tt}),title:s.jsx(u,{message:"This artist does not have any albums yet"})})]})}function Ur({album:e}){const t=Za();return s.jsxs("div",{className:"text-muted",children:[s.jsx(Y,{to:`../../../albums/${e.id}/edit`,relative:"path",children:s.jsx(W,{size:"md",children:s.jsx(ws,{})})}),s.jsxs(ie,{type:"modal",onClose:a=>{a&&t.mutate({albumId:e.id})},children:[s.jsx(W,{size:"md",disabled:t.isLoading,children:s.jsx(ps,{})}),s.jsx(lt,{isDanger:!0,title:s.jsx(u,{message:"Delete album"}),body:s.jsx(u,{message:"Are you sure you want to delete this album?"}),confirm:s.jsx(u,{message:"Delete"})})]})]})}function Er({albums:e,showExternalFields:t}){const a=te();return s.jsxs(me,{children:[s.jsxs("div",{className:"md:flex gap-24",children:[s.jsxs("div",{className:"flex-shrink-0",children:[s.jsx(Ye,{name:"image_small",diskPrefix:"artist_images",label:a?s.jsx(u,{message:"Image"}):null,variant:a?"input":"square",previewSize:a?void 0:"w-full md:w-224 aspect-square",stretchPreview:!0}),t&&s.jsx(Ya,{name:"verified",className:"mt-14",children:s.jsx(u,{message:"Verified"})})]}),s.jsx("div",{className:"flex-auto mt-24 md:mt-0",children:s.jsxs(Xa,{isLazy:!0,children:[s.jsxs(Ja,{children:[s.jsx(Ae,{children:s.jsx(u,{message:"Details"})}),s.jsx(Ae,{children:s.jsx(u,{message:"Links"})}),s.jsx(Ae,{children:s.jsx(u,{message:"Biography"})}),s.jsx(Ae,{children:s.jsx(u,{message:"Images"})})]}),s.jsxs(en,{className:"pt-20",children:[s.jsx(Te,{children:s.jsx(_r,{showExternalFields:t})}),s.jsx(Te,{children:s.jsx(sn,{})}),s.jsx(Te,{children:s.jsx(Or,{})}),s.jsx(Te,{children:s.jsx(Hr,{})})]})]})})]}),s.jsx(zr,{albums:e})]})}function _r({showExternalFields:e}){const{trans:t}=H();return s.jsxs(d.Fragment,{children:[s.jsx(L,{name:"name",label:s.jsx(u,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0,disabled:!e}),s.jsx(ve,{label:s.jsx(u,{message:"Genres"}),placeholder:t(C("+Add genre")),model:bs,name:"genres",allowCustomValue:!0,className:"mb-24"}),e&&s.jsx(Br,{})]})}function Or(){return s.jsxs(d.Fragment,{children:[s.jsx(L,{name:"profile.country",label:s.jsx(u,{message:"Country"}),className:"mb-24"}),s.jsx(L,{name:"profile.city",label:s.jsx(u,{message:"City"}),className:"mb-24"}),s.jsx(L,{inputElementType:"textarea",rows:5,name:"profile.description",label:s.jsx(u,{message:"Description"}),className:"mb-24"})]})}function Hr(){const{fields:e,append:t,remove:a}=nt({name:"profile_images"});return s.jsxs("div",{children:[s.jsx("div",{className:"flex gap-12 flex-wrap mb-24",children:e.map((n,r)=>s.jsx(Ye,{name:`profile_images.${r}.url`,diskPrefix:"artist_images",variant:"square",previewSize:"w-160 h-160",stretchPreview:!0,showRemoveButton:!0,onChange:i=>{i||a(r)}},n.id))}),s.jsx($,{variant:"outline",color:"primary",startIcon:s.jsx(vs,{}),onClick:()=>{t({url:""})},children:s.jsx(u,{message:"Add another image"})})]})}function Br(){const{spotify_is_setup:e}=oe();return e?s.jsx(L,{name:"spotify_id",label:s.jsx(u,{message:"Spotify ID"}),className:"mb-24",minLength:22,maxLength:22}):null}const qr=e=>`artists/${e}`;function Wr(e){const{trans:t}=H(),a=Ie(),{pathname:n}=de();return ce(r=>Gr(r),{onSuccess:r=>{ee(t(C("Artist updated"))),ue.invalidateQueries(xe("artists")),n.includes("admin")?a("/admin/artists"):a(Pa(r.artist))},onError:r=>Ce(r,e)})}function Gr({id:e,...t}){return z.put(qr(e),t).then(a=>a.data)}function wi({wrapInContainer:e,showExternalFields:t}){const a=jt({forEditing:!0,with:"albums,genres,profile",albumsPerPage:50});return a.data?s.jsx(Kr,{response:a.data,wrapInContainer:e,showExternalFields:t}):s.jsx(gs,{query:a,loaderClassName:"absolute inset-0 m-auto"})}function Kr({response:e,wrapInContainer:t,showExternalFields:a}){var i;tn(e.artist);const n=ne({defaultValues:{id:e.artist.id,name:e.artist.name,verified:e.artist.verified,spotify_id:e.artist.spotify_id,genres:e.artist.genres,image_small:e.artist.image_small,links:e.artist.links,profile:e.artist.profile,profile_images:e.artist.profile_images}}),r=Wr(n);return s.jsx(Se,{form:n,onSubmit:o=>{r.mutate(o)},title:s.jsx(u,{message:"Edit “:name“ artist",values:{name:e.artist.name}}),isLoading:r.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:t,children:s.jsx(Er,{albums:(i=e.albums)==null?void 0:i.data,showExternalFields:a})})}const Qr={month:"short",day:"2-digit"};function Zr({value:e,onChange:t,compactOnMobile:a=!0}){const n=te();return s.jsxs(ie,{type:"popover",onClose:r=>{r&&t(r)},children:[s.jsx($,{variant:"outline",color:"chip",endIcon:s.jsx(kt,{}),children:s.jsx(Dt,{start:e.start,end:e.end,options:n&&a?Qr:Js.short})}),s.jsx(Yr,{value:e})]})}function Yr({value:e}){const t=te(),a=on({defaultValue:e,closeDialogOnSelection:!1});return s.jsx(wn,{state:a,showInlineDatePickerField:!t})}function Ds(e){const{title:t,description:a,children:n,className:r,contentIsFlex:i=!0,contentClassName:o,contentRef:l,minHeight:c="min-h-440"}=e;return s.jsxs("div",{className:A("bg border rounded h-full flex flex-col flex-auto",c,r),children:[s.jsxs("div",{className:"text-xs p-14 flex-shrink-0 flex justify-between",children:[s.jsx("div",{className:"font-semibold text-sm",children:t}),a&&s.jsx("div",{className:"text-muted",children:a})]}),s.jsx("div",{ref:l,className:A("p-14 relative",i&&"flex-auto flex items-center justify-center",o),children:n})]})}function He(){return s.jsxs("div",{className:"flex items-center gap-10 text-sm absolute mx-auto",children:[s.jsx(hs,{isIndeterminate:!0,size:"sm"}),s.jsx(u,{message:"Chart loading"})]})}const Xr=d.lazy(()=>Aa(()=>import("./lazy-chart-46225ace.js"),["./lazy-chart-46225ace.js","./main-4c666f43.js","./main-53de3d59.css"],import.meta.url));function qt(e){const{title:t,description:a,className:n,contentRef:r,isLoading:i}=e;return s.jsx(Ds,{title:t,description:a,className:n,contentRef:r,children:s.jsxs(d.Suspense,{fallback:s.jsx(He,{}),children:[s.jsx(Xr,{...e}),i&&s.jsx(He,{})]})})}function Wt(e,{localeCode:t="en",shareFirstDatasetLabels:a=!0}){if(!e)return{datasets:[]};const n=[];return{...e,datasets:e.datasets.map((r,i)=>{const o=r.data.map((l,c)=>{let f;return i===0||!a?(f=Jr(l,e.granularity,t),n[c]=f):f=n[c],{...f,value:l.value}});return{...r,data:o}})}}function Jr(e,t,a){return e.label!=null?{label:e.label}:e.date?ei(e,t,a):{label:""}}function ei({date:e,endDate:t,value:a},n="day",r){const i=Ue(e).toDate(),o=t?Ue(t).toDate():null;switch(n){case"minute":return{label:_(r,{second:"2-digit"}).format(i),tooltipTitle:_(r,{day:"2-digit",hour:"numeric",minute:"numeric",second:"2-digit"}).format(i)};case"hour":return{label:_(r,{hour:"numeric",minute:"numeric"}).format(i),tooltipTitle:_(r,{month:"short",day:"2-digit",hour:"numeric",minute:"numeric"}).format(i)};case"day":return{label:_(r,{day:"2-digit",weekday:"short"}).format(i),tooltipTitle:_(r,{day:"2-digit",weekday:"short",month:"short"}).format(i)};case"week":return{label:_(r,{month:"short",day:"2-digit"}).format(i),tooltipTitle:_(r,{day:"2-digit",month:"long",year:"numeric"}).formatRange(i,o)};case"month":return{label:_(r,{month:"short",year:"numeric"}).format(i),tooltipTitle:_(r,{month:"long",year:"numeric"}).format(i)};case"year":return{label:_(r,{year:"numeric"}).format(i),tooltipTitle:_(r,{year:"numeric"}).format(i)}}}const _=Ta((e,t)=>new $a(e,t),{equals:(e,t)=>et(e,t),callTimeout:void 0}),Os=ge().themes.all[0].colors["--be-primary"],pe=[[`rgb(${Os.replaceAll(" ",",")})`,`rgba(${Os.replaceAll(" ",",")},0.2)`],["rgb(255,112,67)","rgb(255,112,67,0.2)"],["rgb(255,167,38)","rgb(255,167,38,0.2)"],["rgb(141,110,99)","rgb(141,110,99,0.2)"],["rgb(102,187,106)","rgba(102,187,106,0.2)"],["rgb(92,107,192)","rgb(92,107,192,0.2)"]],si={parsing:{xAxisKey:"label",yAxisKey:"value"},datasets:{line:{fill:"origin",tension:.1,pointBorderWidth:4,pointHitRadius:10}},plugins:{tooltip:{intersect:!1,mode:"index"}}};function ti({data:e,className:t,...a}){const{localeCode:n}=le(),r=d.useMemo(()=>{const i=Wt(e,{localeCode:n});return i.datasets=i.datasets.map((o,l)=>({...o,backgroundColor:pe[l][1],borderColor:pe[l][0],pointBackgroundColor:pe[l][0]})),i},[e,n]);return s.jsx(qt,{...a,className:A(t,"min-w-500"),data:r,type:"line",options:si})}const ai={parsing:{key:"value"},plugins:{tooltip:{intersect:!0}}};function Hs({data:e,className:t,...a}){const{localeCode:n}=le(),r=d.useMemo(()=>{var o;const i=Wt(e,{localeCode:n});return i.labels=(o=i.datasets[0])==null?void 0:o.data.map(l=>l.label),i.datasets=i.datasets.map((l,c)=>({...l,backgroundColor:pe.map(f=>f[1]),borderColor:pe.map(f=>f[0]),borderWidth:2})),i},[e,n]);return s.jsx(qt,{type:"polarArea",data:r,options:ai,className:A(t,"min-w-500"),...a})}const Bs="https://www.gstatic.com/charts/loader.js";function ni({placeholderRef:e,data:t}){const{trans:a}=H(),{analytics:n}=oe(),r=n==null?void 0:n.gchart_api_key,{selectedTheme:i}=Va(),o=d.useRef(),l=d.useCallback(()=>{var x,p;if(typeof google>"u")return;const f=t.map(b=>[b.label,b.value]);f.unshift([a(C("Country")),a(C("Clicks"))]);const m=`${Ls(i.colors["--be-paper"])}`,h={colorAxis:{colors:[`${Ls(i.colors["--be-primary"])}`]},backgroundColor:m};!o.current&&e.current&&((x=google==null?void 0:google.visualization)!=null&&x.GeoChart)&&(o.current=new google.visualization.GeoChart(e.current)),(p=o.current)==null||p.draw(google.visualization.arrayToDataTable(f),h)},[i,t,e]),c=d.useCallback(()=>{Rs.alreadyLoading(Bs)||Rs.loadAsset(Bs,{type:"js"}).then(()=>{google.charts.load("current",{packages:["geochart"],mapsApiKey:r}),google.charts.setOnLoadCallback(()=>{l()})})},[r,l]);return d.useEffect(()=>{c()},[c]),d.useEffect(()=>{l()},[i,l,t]),{drawGoogleChart:l}}function ri({data:e,isLoading:t,...a}){const n=d.useRef(null),r=e==null?void 0:e.datasets[0].data,i=d.useMemo(()=>r||[],[r]);return ni({placeholderRef:n,data:i}),s.jsxs(Ds,{...a,className:"min-w-500",title:s.jsx(u,{message:"Top Locations"}),contentIsFlex:t,children:[t&&s.jsx(He,{}),s.jsxs("div",{className:"flex",children:[s.jsx("div",{ref:n,className:"flex-auto w-[480px] min-h-[340px]"}),s.jsx("div",{className:"text-sm max-h-[370px] w-[170px] flex-initial overflow-y-auto",children:i.map(o=>s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"max-w-110 whitespace-nowrap overflow-hidden overflow-ellipsis",children:o.label}),s.jsxs("div",{children:["(",o.percentage,")%"]})]},o.label))})]})]})}const qs="reports/insights";function ii(e,t){return ae([qs,e],()=>li(qs,e),{keepPreviousData:!0,enabled:t.isEnabled})}function li(e,t){var n;const a={model:t.model,metrics:(n=t.metrics)==null?void 0:n.join(",")};return a.startDate=t.dateRange.start.toAbsoluteString(),a.endDate=t.dateRange.end.toAbsoluteString(),a.timezone=t.dateRange.start.timeZone,z.get(e,{params:a}).then(r=>r.data)}const oi=se(s.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");function Me({data:e,isLoading:t,...a}){const n=(e==null?void 0:e.datasets[0].data)||[];return s.jsxs(Ds,{...a,className:"min-w-500 md:min-w-0 w-1/2",contentIsFlex:t,contentClassName:"max-h-[370px] overflow-y-auto compact-scrollbar",children:[t&&s.jsx(He,{}),n.map(r=>s.jsxs("div",{className:"mb-20 text-sm flex items-center justify-between gap-24",children:[s.jsxs("div",{className:"flex items-center gap-8",children:[s.jsx(ci,{model:r.model,size:"w-42 h-42",className:"rounded flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm",children:s.jsx(ui,{model:r.model})}),s.jsx("div",{className:"text-xs text-muted",children:s.jsx(di,{model:r.model})})]})]}),s.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[s.jsx(an,{className:"text-muted",size:"sm"}),s.jsx(u,{message:":count plays",values:{count:s.jsx(Oe,{value:r.value})}})]})]},r.model.id)),!t&&!n.length?s.jsxs("div",{className:"flex items-center gap-8 text-muted",children:[s.jsx(oi,{size:"sm"}),s.jsx(u,{message:"No plays in selected timeframe."})]}):null]})}function ci({model:e,size:t,className:a}){const{pathname:n}=de(),i=n.includes("/admin")?`/admin/${e.model_type}s/${e.id}/insights`:`/backstage/${e.model_type}s/${e.id}/insights`;switch(e.model_type){case"artist":return s.jsx(Y,{to:i,children:s.jsx(dt,{artist:e,size:t,className:a})});case"album":return s.jsx(Y,{to:i,children:s.jsx(Je,{album:e,size:t,className:a})});case"track":return s.jsx(Y,{to:i,children:s.jsx(ys,{track:e,size:t,className:a})});case"user":return s.jsx(nn,{user:e,size:t,className:a})}}function ui({model:e}){switch(e.model_type){case"artist":return s.jsx(mt,{artist:e,target:"_blank"});case"album":return s.jsx(ks,{album:e,target:"_blank"});case"track":return s.jsx(bt,{track:e,target:"_blank"});case"user":return e.id?s.jsx(Ma,{user:e,target:"_blank"}):s.jsx(d.Fragment,{children:e.display_name})}}function di({model:e}){switch(e.model_type){case"artist":case"user":return null;case"album":case"track":return s.jsx(es,{artists:e.artists,target:"_blank"})}}function Ss(e){const a="flex flex-col lg:flex-row lg:items-center overflow-x-auto gap-12 md:gap-24 mb-12 md:mb-24",n=e.model,r=e.dateRange;return s.jsxs(d.Fragment,{children:[s.jsxs("div",{className:a,children:[s.jsx(Q,{metric:"plays",model:n,dateRange:r,children:({data:i})=>s.jsx(ti,{className:"flex-auto",title:s.jsx(u,{message:"Plays"}),hideLegend:!0,description:s.jsx(u,{message:":count total plays",values:{count:s.jsx(Oe,{value:(i==null?void 0:i.report.plays.total)||0})}})})}),s.jsx(Q,{metric:"devices",model:n,dateRange:r,children:s.jsx(Hs,{title:s.jsx(u,{message:"Top devices"})})})]}),s.jsxs("div",{className:a,children:[e.showTracks&&s.jsx(Q,{metric:"tracks",model:n,dateRange:r,children:s.jsx(Me,{title:s.jsx(u,{message:"Most played tracks"})})}),s.jsx(Q,{metric:"users",model:n,dateRange:r,children:s.jsx(Me,{title:s.jsx(u,{message:"Top listeners"})})})]}),e.showArtistsAndAlbums&&s.jsxs("div",{className:a,children:[s.jsx(Q,{metric:"artists",model:n,dateRange:r,children:s.jsx(Me,{title:s.jsx(u,{message:"Most played artists"})})}),s.jsx(Q,{metric:"albums",model:n,dateRange:r,children:s.jsx(Me,{title:s.jsx(u,{message:"Most played albums"})})})]}),s.jsxs("div",{className:a,children:[s.jsx(Q,{metric:"locations",model:n,dateRange:r,children:s.jsx(ri,{className:"flex-auto w-1/2 lg:max-w-[740px]"})}),s.jsx(Q,{metric:"platforms",model:n,dateRange:r,children:s.jsx(Hs,{className:"max-w-500",title:s.jsx(u,{message:"Top platforms"})})})]})]})}function Q({children:e,metric:t,model:a,dateRange:n}){var m,g;const[r,i]=d.useState(!1),o=ii({metrics:[t],model:a,dateRange:n},{isEnabled:r}),l=typeof e=="function"?e(o):e,c=d.useRef(),f=d.useCallback(h=>{var x;if(h){const p=new IntersectionObserver(([b])=>{var v;b.isIntersecting&&(i(!0),(v=c.current)==null||v.disconnect(),c.current=void 0)},{threshold:.1});c.current=p,p.observe(h)}else c.current&&((x=c.current)==null||x.disconnect())},[]);return d.cloneElement(l,{data:(g=(m=o.data)==null?void 0:m.report)==null?void 0:g[t],isLoading:o.isLoading,contentRef:f})}function Ps({children:e,reportModel:t,title:a,isNested:n}){const[r,i]=d.useState(()=>yt[2].getRangeValue());return s.jsxs(d.Fragment,{children:[s.jsx(Fa,{children:s.jsx(u,{message:"Insights"})}),s.jsxs("div",{className:"h-full flex flex-col",children:[!n&&s.jsx(ct,{className:"flex-shrink-0",color:"bg",darkModeColor:"bg"}),s.jsx("div",{className:"overflow-y-auto flex-auto bg-cover relative",children:s.jsxs("div",{className:"min-h-full p-12 md:p-24 overflow-x-hidden max-w-[1600px] mx-auto flex flex-col",children:[s.jsxs("div",{className:"flex-auto",children:[s.jsxs("div",{className:"md:flex items-center justify-between gap-24 h-48 mt-14 mb-38",children:[a||s.jsx(he,{className:"max-w-320"}),s.jsx("div",{className:"flex-shrink-0 flex items-center justify-between gap-10 md:gap-24",children:s.jsx(Zr,{value:r,onChange:i})})]}),d.cloneElement(e,{dateRange:r,model:t})]}),!n&&s.jsx(ut,{})]})})]})]})}function As({image:e,name:t,description:a}){return s.jsxs("div",{className:"flex items-center gap-10",children:[d.cloneElement(e,{size:"w-48 h-48",className:"rounded"}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-base whitespace-nowrap overflow-hidden overflow-ellipsis",children:["“",t,"“ ",s.jsx(u,{message:"insights"})]}),a&&s.jsx("div",{className:"text-muted text-sm",children:a})]})]})}function Ni({isNested:e}){const{artistId:t}=Xe(),{data:a}=jt({});return s.jsx(Ps,{reportModel:`artist=${t}`,title:(a==null?void 0:a.artist)&&s.jsx(As,{image:s.jsx(dt,{artist:a.artist}),name:s.jsx(mt,{artist:a.artist})}),isNested:e,children:s.jsx(Ss,{showTracks:!0})})}function Ci({isNested:e}){const{albumId:t}=Xe(),{data:a}=pt({});return s.jsx(Ps,{reportModel:`album=${t}`,title:(a==null?void 0:a.album)&&s.jsx(As,{image:s.jsx(Je,{album:a.album}),name:s.jsx(ks,{album:a.album}),description:s.jsx(es,{artists:a.album.artists})}),isNested:e,children:s.jsx(Ss,{showTracks:!0})})}function Ii({isNested:e}){const{trackId:t}=Xe(),{data:a}=ht({});return s.jsx(Ps,{reportModel:`track=${t}`,title:(a==null?void 0:a.track)&&s.jsx(As,{image:s.jsx(ys,{track:a.track}),name:s.jsx(bt,{track:a.track}),description:s.jsx(es,{artists:a.track.artists})}),isNested:e,children:s.jsx(Ss,{})})}export{cn as A,qt as B,Un as C,wn as D,vi as E,Mn as F,ri as G,ji as H,Wn as I,Ci as J,wi as K,bn as L,Ni as M,bi as N,Tr as O,Hs as P,_n as Q,Zr as R,Mt as S,oi as T,gi as U,Nt as a,kt as b,ls as c,yt as d,Dt as e,Pt as f,hi as g,xe as h,vn as i,At as j,En as k,De as l,Se as m,St as n,Bn as o,Tt as p,yi as q,ki as r,Er as s,Wt as t,on as u,pe as v,ti as w,Ss as x,pi as y,Ii as z};
//# sourceMappingURL=backstage-track-insights-24cd596a.js.map
